* * *

**Users / Groups:** `useradd`, `userdel`, `usermod`, `groupadd`, `groupdel`, `groupmod`, `id`, `groups`, `newgrp`

* * *

* * *

# Linux `useradd` Command

The `useradd` command is used to create new user accounts in Linux systems.  
It is a low-level utility that directly modifies system account files.

It works with the following files:

- `/etc/passwd`
    
- `/etc/shadow`
    
- `/etc/group`
    
- `/etc/gshadow`
    

On many modern Linux distributions, `adduser` exists as a higher-level wrapper, but `useradd` is available everywhere and is preferred for scripting and system administration.

* * *

## 1\. Basic Syntax

```
useradd [OPTIONS] username
```

* * *

## 2\. What Happens When You Run `useradd`

By default, `useradd`:

- Adds a new entry to `/etc/passwd`
    
- Adds a corresponding entry to `/etc/shadow`
    
- Creates a group with the same name (on most distributions)
    
- Assigns a UID and GID
    
- Assigns a default shell
    
- Does not set a password
    
- Does not always create a home directory unless configured
    

* * *

## 3\. Important Files Used by `useradd`

| File | Purpose |
| --- | --- |
| `/etc/passwd` | User account information |
| `/etc/shadow` | Encrypted passwords |
| `/etc/group` | Group information |
| `/etc/gshadow` | Secure group information |
| `/etc/login.defs` | System-wide user defaults |
| `/etc/default/useradd` | useradd default settings |
| `/etc/skel/` | Template files for new home directories |

* * *

## 4\. Basic Examples

### Create a User

```
sudo useradd john
```

This creates the user `john` but does not set a password.

* * *

### Set Password for a User

```
sudo passwd john
```

* * *

## 5\. Commonly Used Options

### `-m` Create Home Directory

```
sudo useradd -m john
```

Creates `/home/john` using files from `/etc/skel`.

* * *

### `-M` Do Not Create Home Directory

```
sudo useradd -M john
```

* * *

### `-d` Specify Home Directory

```
sudo useradd -m -d /data/john john
```

* * *

### `-s` Specify Login Shell

```
sudo useradd -s /bin/bash john
```

Common shells:

- `/bin/bash`
    
- `/bin/sh`
    
- `/bin/zsh`
    
- `/usr/sbin/nologin`
    

* * *

### `-u` Specify User ID

```
sudo useradd -u 1500 john
```

The UID must be unique.

* * *

### `-g` Specify Primary Group

```
sudo useradd -g developers john
```

The group must already exist.

* * *

### `-G` Specify Supplementary Groups

```
sudo useradd -G wheel,docker,audio john
```

Multiple groups are separated by commas.

* * *

### `-c` Add Comment or Full Name

```
sudo useradd -c "John Doe - DevOps Engineer" john
```

Stored in the GECOS field of `/etc/passwd`.

* * *

### `-e` Account Expiry Date

```
sudo useradd -e 2026-12-31 john
```

Date format is YYYY-MM-DD.

* * *

### `-f` Password Inactivity Period

```
sudo useradd -f 30 john
```

Locks the account after 30 days of password expiration.

* * *

### `-r` Create System User

```
sudo useradd -r nginx
```

System users are typically used for services.

* * *

## 6\. Full Real-World Example

```
sudo useradd \
  -m \
  -u 1050 \
  -g developers \
  -G wheel,docker \
  -s /bin/bash \
  -c "John Doe - Backend Engineer" \
  -e 2027-01-01 \
  john
```

Set the password:

```
sudo passwd john
```

* * *

## 7\. View Default `useradd` Settings

```
useradd -D
```

Example output:

```
GROUP=100
HOME=/home
INACTIVE=-1
EXPIRE=
SHELL=/bin/sh
SKEL=/etc/skel
CREATE_MAIL_SPOOL=yes
```

Change default shell:

```
sudo useradd -D -s /bin/bash
```

* * *

## 8\. `/etc/login.defs`

This file controls:

- UID and GID ranges
    
- Password aging policies
    
- Home directory permissions
    

Example:

```
UID_MIN 1000
UID_MAX 60000
PASS_MAX_DAYS 99999
PASS_MIN_DAYS 0
PASS_WARN_AGE 7
```

* * *

## 9\. Verify User Creation

### Check `/etc/passwd`

```
grep john /etc/passwd
```

### Check User ID

```
id john
```

### Check Home Directory

```
ls -ld /home/john
```

* * *

## 10\. Lock and Unlock a User

### Lock User Account

```
sudo usermod -L john
```

### Unlock User Account

```
sudo usermod -U john
```

* * *

## 11\. Delete a User

Delete user only:

```
sudo userdel john
```

Delete user and home directory:

```
sudo userdel -r john
```

* * *

## 12\. `useradd` vs `adduser`

| Feature | useradd | adduser |
| --- | --- | --- |
| Interactive | No  | Yes |
| Script-friendly | Yes | No  |
| Available on all distros | Yes | No  |
| Auto home creation | No  | Yes |

* * *

## 13\. Best Practices

- Always use `-m` unless there is a reason not to
    
- Always set a password after creating a user
    
- Use system users for services
    
- Do not manually edit `/etc/passwd`
    
- Use `usermod` for changes
    

* * *

## 14\. Quick Cheat Sheet

```
useradd -m username
passwd username

useradd -m -s /bin/bash username
useradd -m -G sudo,docker username
useradd -r serviceuser
useradd -e 2026-12-31 username
```

* * *

## 15\. Summary

- `useradd` is the core Linux tool for creating users
    
- It is powerful and suitable for automation
    
- Understanding default behavior is essential
    
- Widely used in servers and enterprise environments
    

* * *

* * *

# Linux `userdel` Command

The `userdel` command in Linux is used to delete a user account along with its related files. It is part of the `passwd` package.

* * *

## Syntax

```bash
userdel [options] username
```

## Common Options

| Option | Description |
| --- | --- |
| `-r` | Removes the home directory and mail spool of the user. |
| `-f` | Forces the removal of the user account, even if the user is logged in. |
| `-h` | Displays help information about the command. |

* * *

## Examples

### 1\. Delete a User Without Removing Home Directory

```bash
sudo userdel john
```

- Deletes the user `john` from the system.
    
- Home directory and files remain.
    

### 2\. Delete a User and Remove Home Directory

```bash
sudo userdel -r john
```

- Deletes the user `john`.
    
- Removes `/home/john` and the user's mail spool.
    

### 3\. Force Delete a User Even if Logged In

```bash
sudo userdel -f john
```

- Forces deletion of `john` even if the user is logged in.

### 4\. Display Help Information

```bash
userdel -h
```

- Shows a help message with command options.

* * *

## Notes

1.  Always use `sudo` or root privileges to delete users.
    
2.  Check if the user is logged in before deletion using:
    

```bash
who | grep username
```

3.  Be cautious with the `-r` option; it deletes all files in the user's home directory permanently.

* * *

## Summary

- `userdel` removes user accounts.
    
- `-r` removes home directory and mail.
    
- `-f` forces deletion.
    
- Must have root privileges.
    

* * *

* * *

# Linux `usermod` Command

The `usermod` command in Linux is used to modify an existing user account. It allows you to change a user's properties like username, home directory, shell, group memberships, and more.

* * *

## Syntax

```bash
usermod [options] username
```

- `username`: The name of the existing user you want to modify.

* * *

## Common Options

| Option | Description |
| --- | --- |
| `-l new_username` | Change the username. |
| `-d /new/home/dir` | Change the user's home directory. |
| `-m` | Move contents of the old home directory to the new one (use with `-d`). |
| `-s /path/to/shell` | Change the user's login shell. |
| `-g group` | Change the user's primary group. |
| `-G group1,group2` | Set the user's supplementary groups (comma-separated). |
| `-a -G group` | Append user to a supplementary group (use with `-G`). |
| `-L` | Lock the user account (disable login). |
| `-U` | Unlock the user account. |
| `-e YYYY-MM-DD` | Set account expiration date. |
| `-f days` | Set number of days after password expiration before account is disabled. |

* * *

## Examples

### 1\. Change a username

```bash
sudo usermod -l newusername oldusername
```

### 2\. Change the home directory

```bash
sudo usermod -d /home/newdir -m username
```

### 3\. Change the login shell

```bash
sudo usermod -s /bin/zsh username
```

### 4\. Change the primary group

```bash
sudo usermod -g developers username
```

### 5\. Add user to supplementary groups

```bash
sudo usermod -a -G sudo,adm username
```

### 6\. Lock a user account

```bash
sudo usermod -L username
```

### 7\. Unlock a user account

```bash
sudo usermod -U username
```

### 8\. Set account expiration date

```bash
sudo usermod -e 2026-12-31 username
```

### 9\. Force account disable after password expiration

```bash
sudo usermod -f 10 username
```

* * *

> **Note:** Always use `sudo` when modifying system users.

This covers most practical uses of the `usermod` command in Linux.

* * *

* * *

# Linux `groupadd` Command

The `groupadd` command in Linux is used to create a new group. Groups are a way to manage permissions and access to files for multiple users.

* * *

## Syntax

```bash
groupadd [options] group_name
```

- `group_name`: The name of the group you want to create.

## Common Options

| Option | Description |
| --- | --- |
| `-g GID` | Specify a custom Group ID (GID) for the group. |
| `-r` | Create a system group (GID less than 1000, depending on the system). |
| `-f` | Force the creation. If the group exists, do not return an error. |
| `-K KEY=VALUE` | Override `/etc/login.defs` defaults. |

## Examples

### 1\. Create a Simple Group

```bash
sudo groupadd developers
```

- Creates a group named `developers`.

### 2\. Create a Group with a Specific GID

```bash
sudo groupadd -g 1500 designers
```

- Creates a group named `designers` with GID `1500`.

### 3\. Create a System Group

```bash
sudo groupadd -r systemadmins
```

- Creates a system group `systemadmins` with a system GID (usually below 1000).

### 4\. Force Creation if Group Already Exists

```bash
sudo groupadd -f developers
```

- If `developers` already exists, it will not return an error.

### 5\. Override Defaults from `/etc/login.defs`

```bash
sudo groupadd -K PASS_MAX_DAYS=30 hr
```

- Creates a group `hr` and overrides default login definition settings.

## Verification

After creating a group, you can check it using:

```bash
getent group group_name
```

Or view all groups:

```bash
cat /etc/group
```

* * *

This guide covers the basic and most commonly used options of `groupadd` with examples for practical usage.

* * *

* * *

# Linux `groupdel` Command

The `groupdel` command in Linux is used to delete a group from the system. This can be useful when you no longer need a group or want to clean up unused groups.

* * *

## Syntax

```bash
groupdel [options] group_name
```

- `group_name`: Name of the group you want to delete.

### Notes:

- Only the root user or a user with sudo privileges can delete groups.
    
- You cannot delete a group that is currently being used by any user as their primary group.
    

* * *

## Options

`groupdel` has very minimal options:

- There are no specific flags for `groupdel`. The basic usage is simply:
    
    ```bash
    sudo groupdel group_name
    ```
    

* * *

## Examples

### 1\. Delete a group named `developers`

```bash
sudo groupdel developers
```

- This deletes the group `developers` from the system.
    
- If the group does not exist, you will get an error:
    
    ```bash
    groupdel: group 'developers' does not exist
    ```
    

### 2\. Attempting to delete a group that is a primary group for a user

- Suppose the group `admin` is the primary group for user `john`:

```bash
id john
# Output might be: uid=1001(john) gid=1002(admin) groups=1002(admin),1003(sudo)

sudo groupdel admin
# Output: groupdel: cannot remove the primary group of user 'john'
```

- You must first change the primary group of any user using `usermod` before deleting the group:

```bash
sudo usermod -g newgroup john
sudo groupdel admin
```

### 3\. Delete multiple groups (one by one)

```bash
sudo groupdel group1
sudo groupdel group2
sudo groupdel group3
```

* * *

## Verification

- To check if the group has been deleted:

```bash
getent group group_name
```

- If the command returns nothing, the group has been successfully deleted.

* * *

## Important Notes

- Always ensure no user is actively using the group as their primary group.
    
- `groupdel` does not remove the user's membership in other groups, only the group itself.
    
- You can view all groups with:
    

```bash
cat /etc/group
```

* * *

* * *

# Linux `groupmod` Command

The `groupmod` command in Linux is used to modify an existing group. You can change the group name or its Group ID (GID).

* * *

## Syntax

```bash
groupmod [options] GROUP
```

- `GROUP`: The name of the group you want to modify.
    
- Options:
    
    - `-g GID` : Change the Group ID (GID) of the group.
        
    - `-n NEW_GROUP` : Change the name of the group.
        

* * *

## Common Options

| Option | Description |
| --- | --- |
| `-g GID` | Assign a new GID to the group |
| `-n NEW_GROUP` | Rename the group |
| `--help` | Display help information |

* * *

## Examples

### 1\. Change the group name

Suppose you have a group called `developers` and you want to rename it to `devteam`.

```bash
sudo groupmod -n devteam developers
```

**Explanation:**

- `-n devteam` sets the new name.
    
- `developers` is the current group name.
    

### 2\. Change the GID of a group

Suppose the `devteam` group currently has a GID of 1001 and you want to change it to 2001.

```bash
sudo groupmod -g 2001 devteam
```

**Explanation:**

- `-g 2001` sets the new GID.
    
- `devteam` is the group being modified.
    

### 3\. Check the changes

After modifying the group, you can verify the change by looking at `/etc/group`:

```bash
grep devteam /etc/group
```

**Output example:**

```
devteam:x:2001:
```

### 4\. Combine renaming and GID change (optional)

You can rename a group and change its GID in separate commands. However, `groupmod` allows only one modification per command. So you do it step by step:

```bash
sudo groupmod -n devteam developers
sudo groupmod -g 2001 devteam
```

* * *

## Notes

1.  You must have root or sudo privileges to use `groupmod`.
    
2.  Be careful when changing GID. If files exist with the old GID, you may need to update ownership using `chgrp`.
    
3.  Always verify changes in `/etc/group`.
    

* * *

* * *

# Linux `id` Command

The `id` command in Linux is used to display user identity information. This includes the user ID (UID), group ID (GID), and the groups a user belongs to.

* * *

## Syntax

```bash
id [OPTION]... [USER]
```

### Options

| Option | Description |
| --- | --- |
| `-u` | Display only the effective user ID |
| `-g` | Display only the effective group ID |
| `-G` | Display all group IDs |
| `-n` | Display the name instead of the numeric ID (used with `-u`, `-g`, or `-G`) |
| `-r` | Display the real ID instead of the effective ID |
| `-a` | This option is ignored (included for compatibility) |

* * *

## Examples

### 1\. Display current user ID and groups

```bash
id
```

**Output example:**

```
uid=1000(sushil) gid=1000(sushil) groups=1000(sushil),27(sudo),1001(developers)
```

- `uid=1000(sushil)` → User ID is 1000, username is `sushil`
    
- `gid=1000(sushil)` → Primary group ID is 1000, group name is `sushil`
    
- `groups` → User is member of multiple groups
    

### 2\. Display only the user ID

```bash
id -u
```

**Output example:**

```
1000
```

### 3\. Display only the username

```bash
id -un
```

**Output example:**

```
sushil
```

### 4\. Display only the group ID

```bash
id -g
```

**Output example:**

```
1000
```

### 5\. Display only the group name

```bash
id -gn
```

**Output example:**

```
sushil
```

### 6\. Display all group IDs the user belongs to

```bash
id -G
```

**Output example:**

```
1000 27 1001
```

### 7\. Display all group names the user belongs to

```bash
id -Gn
```

**Output example:**

```
sushil sudo developers
```

### 8\. Display info for a specific user

```bash
id alice
```

**Output example:**

```
uid=1001(alice) gid=1002(alice) groups=1002(alice),27(sudo)
```

### 9\. Display real user and group IDs

```bash
id -ur   # real user ID
id -gr   # real group ID
```

* * *

### Summary

- `id` is a quick way to see user and group information.
    
- `-u`, `-g`, `-G` focus on UID, GID, or all groups.
    
- `-n` prints names instead of numbers.
    
- You can check info for other users by specifying a username.
    

* * *

* * *

# Linux `groups` Command

The `groups` command in Linux is used to display the groups a user belongs to. This is helpful for understanding user permissions and access rights.

* * *

## Syntax

```bash
groups [username]
```

- If you run `groups` without specifying a username, it shows the groups for the current user.
    
- If you provide a username, it shows the groups for that specific user.
    

* * *

## Basic Usage

### 1\. Check groups for the current user

```bash
$ groups
```

**Example Output:**

```
users sudo
```

This means the current user belongs to the `users` and `sudo` groups.

### 2\. Check groups for a specific user

```bash
$ groups username
```

**Example:**

```bash
$ groups sushil
```

**Example Output:**

```
sushil : users wheel docker
```

This shows the user `sushil` belongs to `users`, `wheel`, and `docker` groups.

### 3\. Using `id` for detailed group info

The `id` command can also show group membership:

```bash
$ id username
```

**Example:**

```bash
$ id sushil
```

**Output:**

```
uid=1001(sushil) gid=1001(sushil) groups=1001(sushil),10(wheel),999(docker)
```

This includes the numeric group IDs (GID) as well.

* * *

## Practical Examples

### Example 1: Current user groups

```bash
$ groups
users sudo
```

### Example 2: Groups of another user

```bash
$ groups root
root : root
```

### Example 3: Verify if a user is in a specific group

```bash
$ groups sushil | grep sudo
sudo
```

If there is no output, the user is not in that group.

### Example 4: Using `id` for extra info

```bash
$ id sushil
uid=1001(sushil) gid=1001(sushil) groups=1001(sushil),10(wheel),999(docker)
```

* * *

## Summary

- `groups`: Show groups of the current user or specified user.
    
- `groups username`: Show groups of a specific user.
    
- `id username`: Show UID, GID, and all groups with numeric IDs.
    
- Helpful for checking permissions and access rights.
    

* * *

**Tip:** Combine with `grep` to check for a specific group membership quickly.

* * *

* * *

# `newgrp` Command in Linux

The `newgrp` command in Linux is used to change the current group ID (GID) during a login session. It allows a user to switch their primary group to another group they are a member of without logging out and back in.

* * *

## **Syntax**

```bash
newgrp [group_name]
```

- `group_name`: The name of the group you want to switch to.

If no `group_name` is specified, it will change to the user's login group.

* * *

## **Key Points**

- The command changes the **primary group** ID of the current session.
    
- Permissions for newly created files are determined by the current primary group.
    
- To switch to a group, you must be a member of that group.
    
- The change only affects the current session (shell).
    

* * *

## **Examples**

### 1\. **Switch to a specific group**

Suppose a user is part of `developers` group and wants to switch to it:

```bash
$ groups
sushil wheel developers

$ newgrp developers
$ id
uid=1000(sushil) gid=1001(developers) groups=1000(sushil),1001(developers),10(wheel)
```

- Here, the primary group has changed to `developers`.

### 2\. **Check the current group**

```bash
$ id -gn
developers
```

- `id -gn` prints the current primary group.

### 3\. **Create a file with new group permissions**

After switching to a new group:

```bash
$ newgrp developers
$ touch project.txt
$ ls -l project.txt
-rw-r--r-- 1 sushil developers 0 Jan 20 20:00 project.txt
```

- The file now belongs to the `developers` group.

### 4\. **Switch back to your default group**

```bash
$ newgrp
$ id -gn
sushil
```

- Running `newgrp` without arguments switches back to your login group.

### 5\. **Using `newgrp` with password-protected groups**

- Some groups may require a password for access.

```bash
$ newgrp admin
Password:
```

- Enter the group password to switch.

* * *

## **Notes**

- `newgrp` is often used in **multi-user environments** to manage file permissions easily.
    
- It is temporary; when you exit the shell, your primary group returns to default.
    
- Useful in **project collaboration** where files need a specific group ownership.
    

* * *

**Tip:** Use `exit` to return to the previous group session if needed.

* * *

* * *

&nbsp;
