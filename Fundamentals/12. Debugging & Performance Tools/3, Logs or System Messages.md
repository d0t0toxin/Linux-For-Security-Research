***
**Logs / System Messages:** `dmesg`, `journalctl`, `logger`, `tail -f /var/log/*`, `ausearch`
***
***
# DMESG Command in Linux

## Overview

The dmesg command in Linux is used to examine or control the kernel ring buffer. This buffer stores messages generated by the kernel, especially during system boot, hardware detection, and driver loading.

## Syntax

dmesg \[options\]

## Common Options

- `-C`, `--clear` : Clear the kernel ring buffer.
    
- `-c`, `--read-clear` : Print and clear the kernel ring buffer.
    
- `-T`, `--ctime` : Show human-readable timestamps.
    
- `-n level`, `--level=level` : Set the level of messages printed to the console.
    
- `-f facility` : Filter messages by facility.
    
- `--kernel` : Show only kernel messages.
    
- `--userspace` : Show only userspace messages.
    
- `-s size` : Set the buffer size for reading messages.
    
- `-e` : Show messages in an extended format.
    
- `--help` : Display help information.
    

## Message Levels

The kernel classifies messages by priority:

- 0: emerg (emergency)
    
- 1: alert
    
- 2: crit (critical)
    
- 3: err (error)
    
- 4: warning
    
- 5: notice
    
- 6: info
    
- 7: debug
    

## Examples

### 1\. Display All Kernel Messages

```
dmesg
```

### 2\. Display Kernel Messages with Human-Readable Timestamps

```
dmesg -T
```

### 3\. Filter Messages by Priority Level

```
dmesg --level=err,warn
```

### 4\. Clear the Kernel Ring Buffer

```
dmesg -C
```

### 5\. Read and Clear Messages

```
dmesg -c
```

### 6\. Show Messages with Extended Format

```
dmesg -e
```

### 7\. Limit Message Output to Kernel or Userspace

```
dmesg --kernel
```

```
dmesg --userspace
```

### 8\. Set the Buffer Size

```
dmesg -s 16384
```

### 9\. Filter Messages by Facility

```
dmesg -f daemon
```

## Notes

- Root privileges may be required for certain dmesg operations.
    
- dmesg is useful for diagnosing hardware and driver issues.
    
- It is commonly used in conjunction with grep to search for specific messages.
    

### Example with grep

```
dmesg | grep usb
```

This command filters all kernel messages related to USB devices.

* * *

* * *

# journalctl Command in Linux

## Overview

The journalctl command in Linux is used to query and display messages from the systemd journal. This journal stores logs from the kernel, system services, and applications in a structured and centralized manner.

## Syntax

journalctl \[options\] \[MATCHES...\]

## Common Options

- `-b`, `--boot` : Show messages from the current or specified boot.
    
- `-k`, `--dmesg` : Show kernel messages.
    
- `-u UNIT`, `--unit=UNIT` : Show messages for a specific systemd unit.
    
- `-p PRIORITY`, `--priority=PRIORITY` : Show messages with specific priority.
    
- `-f`, `--follow` : Continuously display new messages in real-time.
    
- `-n NUM`, `--lines=NUM` : Show the last NUM lines of logs.
    
- `--since=TIME` : Show messages since a specific time.
    
- `--until=TIME` : Show messages until a specific time.
    
- `-o FORMAT`, `--output=FORMAT` : Specify output format (short, verbose, json, etc.).
    
- `--no-pager` : Disable paging.
    
- `--list-boots` : List recorded boots with their IDs and timestamps.
    
- `--disk-usage` : Show the disk space used by journal logs.
    
- `--vacuum-size=SIZE` : Reduce journal size to specified amount.
    

## Priority Levels

The priority levels for filtering logs are:

- 0: emerg
    
- 1: alert
    
- 2: crit
    
- 3: err
    
- 4: warning
    
- 5: notice
    
- 6: info
    
- 7: debug
    

## Examples

### 1\. Display All Logs

```
journalctl
```

### 2\. Display Logs from Current Boot

```
journalctl -b
```

### 3\. Display Kernel Messages

```
journalctl -k
```

### 4\. Follow Logs in Real-Time

```
journalctl -f
```

### 5\. Display Last 50 Lines

```
journalctl -n 50
```

### 6\. Filter Logs by Unit

```
journalctl -u ssh.service
```

### 7\. Filter Logs by Priority

```
journalctl -p err
```

### 8\. Display Logs for a Specific Time Range

```
journalctl --since "2026-01-20 08:00:00" --until "2026-01-20 12:00:00"
```

### 9\. Display Logs in JSON Format

```
journalctl -o json
```

### 10\. Show Disk Usage of Journal Logs

```
journalctl --disk-usage
```

### 11\. Vacuum Old Logs to Limit Disk Usage

```
journalctl --vacuum-size=500M
```

### 12\. List All Boots

```
journalctl --list-boots
```

## Notes

- Root privileges may be required for accessing all logs.
    
- journalctl provides structured and indexed logs, making it efficient for filtering and searching.
    
- Often used in combination with grep for specific keyword searches.
    

### Example with grep

```
journalctl | grep network
```

This command filters all journal messages related to networking.

* * *

* * *

# logger Command in Linux

## Overview

The logger command in Linux provides a shell command interface to the syslog system log module. It allows users to create log messages from the command line, scripts, or programs, which are then recorded in system logs.

## Syntax

logger \[options\] \[message\]

## Common Options

- `-i`, `--id` : Include the process ID in the log message.
    
- `-s`, `--stderr` : Output the message to standard error as well as the system log.
    
- `-f FILE`, `--file=FILE` : Log the contents of a specified file.
    
- `-p PRIORITY`, `--priority=PRIORITY` : Specify the priority of the message.
    
- `-t TAG`, `--tag=TAG` : Specify a tag for the message.
    
- `-u SOCKET`, `--socket=SOCKET` : Write to an alternate syslog socket.
    
- `--rfc3164` : Use RFC 3164 format.
    
- `--rfc5424` : Use RFC 5424 format.
    
- `--help` : Display help information.
    
- `--version` : Display version information.
    

## Priority Levels

The priority level is specified as `facility.level` or just `level`. Common levels include:

- emerg
    
- alert
    
- crit
    
- err
    
- warning
    
- notice
    
- info
    
- debug
    

Common facilities:

- auth, authpriv, cron, daemon, kern, lpr, mail, news, syslog, user, uucp, local0 to local7

## Examples

### 1\. Log a Simple Message

```
logger "System update completed successfully"
```

### 2\. Log a Message with a Tag

```
logger -t UPDATE "System update completed successfully"
```

### 3\. Log a Message with a Priority

```
logger -p local0.notice "Backup completed"
```

### 4\. Include Process ID in Log

```
logger -i "Process started successfully"
```

### 5\. Log the Contents of a File

```
logger -f /var/log/myapp.log
```

### 6\. Output Message to Standard Error and Syslog

```
logger -s "An error occurred"
```

### 7\. Log with a Specific Facility and Level

```
logger -p daemon.warning "Daemon memory usage high"
```

### 8\. View Logged Messages Using journalctl

```
journalctl -t UPDATE
```

This filters journal logs by the tag UPDATE.

### 9\. Log Messages from a Script

Example shell script to log an event:

```
#!/bin/bash
logger -t SCRIPT "Script executed successfully"
```

### 10\. Specify Syslog Socket

```
logger --socket /dev/log "Custom socket log message"
```

## Notes

- logger is useful for adding custom messages to system logs.
    
- Can be integrated into scripts for automated logging.
    
- Supports both traditional syslog and systemd journal.
    

* * *

* * *

# tail -f /var/log/\* Command in Linux

## Overview

The tail command in Linux is used to display the last lines of a file. When used with the `-f` option, it continuously monitors the file for new content, making it useful for real-time log monitoring.

The command `tail -f /var/log/*` monitors all files in the `/var/log` directory, displaying new entries as they are written.

## Syntax

tail -f \[file...\]

## Options

- `-f`, `--follow` : Output appended data as the file grows.
    
- `-n NUM`, `--lines=NUM` : Show the last NUM lines instead of the default 10.
    
- `--retry` : Keep trying to open a file if it is inaccessible.
    
- `-q`, `--quiet`, `--silent` : Do not output headers when monitoring multiple files.
    
- `-v`, `--verbose` : Always output headers with filenames.
    

## Examples

### 1\. Monitor a Single Log File

```
tail -f /var/log/syslog
```

This displays new messages added to the syslog in real-time.

### 2\. Monitor Multiple Log Files

```
tail -f /var/log/auth.log /var/log/syslog
```

This shows updates from both the auth.log and syslog files.

### 3\. Monitor All Files in /var/log

```
tail -f /var/log/*
```

This monitors all log files in `/var/log` and outputs new entries as they appear.

### 4\. Monitor the Last 50 Lines of a Log File

```
tail -n 50 -f /var/log/syslog
```

This displays the last 50 lines and then continues to follow new entries.

### 5\. Use Quiet Mode to Suppress Headers

```
tail -q -f /var/log/*.log
```

This follows all `.log` files in `/var/log` without showing filenames as headers.

### 6\. Retry Access to Inaccessible Files

```
tail --retry -f /var/log/secure
```

This keeps trying to open the file if it becomes temporarily unavailable.

### 7\. Monitor Logs with grep

```
tail -f /var/log/syslog | grep ssh
```

This continuously monitors the syslog and filters entries related to SSH.

### 8\. Monitor Kernel Logs

```
tail -f /var/log/kern.log
```

This is useful for real-time kernel message monitoring.

## Notes

- Root privileges may be required to read certain log files in `/var/log`.
    
- Useful for debugging applications, monitoring system events, and tracking service activity.
    
- Can be combined with tools like grep, awk, and sed for more complex log analysis.
    
- Press Ctrl+C to stop monitoring.
    

* * *

* * *

# ausearch Command in Linux

## Overview

The ausearch command is part of the Linux Audit framework. It is used to search audit logs generated by the auditd service. This command allows administrators to query, filter, and analyze security-related events on a Linux system.

## Syntax

ausearch \[options\]

## Common Options

- `-a, --all` : Search for all audit records.
    
- `-c, --command` : Filter records by command name.
    
- `-p, --pid` : Filter records by process ID.
    
- `-ua, --user` : Filter records by user ID or login name.
    
- `-m, --message` : Filter by message type.
    
- `-ts, --start` : Specify the start time for search (format: YYYY-MM-DD HH:MM:SS).
    
- `-te, --end` : Specify the end time for search.
    
- `-k, --key` : Filter records by audit key.
    
- `-i, --interpret` : Display human-readable output instead of raw audit data.
    
- `-x, --success` : Filter for success or failure events.
    
- `-f, --format` : Display in a specific format (raw, csv, etc.).
    
- `--help` : Show help information.
    

## Examples

### 1\. Search All Audit Records

```
ausearch -a
```

Displays all available audit records.

### 2\. Search by Command Name

```
ausearch -c passwd
```

Shows audit records for the `passwd` command.

### 3\. Search by User

```
ausearch -ua root
```

Displays all audit records for the user `root`.

### 4\. Search by Process ID

```
ausearch -p 1234
```

Shows records related to process ID 1234.

### 5\. Search by Audit Key

```
ausearch -k login_attempt
```

Filters audit records tagged with the key `login_attempt`.

### 6\. Search by Time Range

```
ausearch -ts 2026-01-20 08:00:00 -te 2026-01-20 12:00:00
```

Displays audit events that occurred between the specified start and end times.

### 7\. Show Human-Readable Output

```
ausearch -i -k login_attempt
```

Outputs audit records for the key `login_attempt` in an interpreted, human-readable format.

### 8\. Search for Successful or Failed Events

```
ausearch -x success
```

Shows only successful events.

```
ausearch -x failure
```

Shows only failed events.

### 9\. Filter by Message Type

```
ausearch -m USER_LOGIN
```

Displays only messages of type `USER_LOGIN`.

### 10\. Combine Filters

```
ausearch -ua root -c passwd -k passwd_change -ts today
```

Searches for all `passwd` command events executed by root today with the key `passwd_change`.

## Notes

- The auditd service must be running to capture events.
    
- Root privileges are typically required to access audit logs.
    
- ausearch is powerful for security auditing, compliance monitoring, and forensic analysis.
    
- Can be combined with aureport for summarized reports.
    

* * *

* * *

&nbsp;
