* * *

**Filesystem Checking and Tuning:** `fsck`, `tune2fs`, `dumpe2fs`

* * *

* * *

# `fsck` Command in Linux

`fsck` (File System Consistency Check) is a command-line utility used to **check and repair Linux filesystems**. It works with various filesystem types like ext2, ext3, ext4, xfs (with specific tools), etc.

* * *

## 1\. What is `fsck`?

- Checks for **filesystem errors** caused by improper shutdown, hardware issues, or corruption.
    
- Can **repair errors automatically**.
    
- Must **not be run on mounted partitions** (except read-only checks).
    
- Supports multiple filesystems: ext2, ext3, ext4, reiserfs, xfs (via `xfs_repair`).
    

* * *

## 2\. Syntax

```bash
sudo fsck [options] <device>
```

- `<device>`: Partition or disk to check, e.g., `/dev/sda1`
    
- `options` control behavior (auto-fix, verbosity, etc.)
    

Example:

```bash
sudo fsck /dev/sda1
```

* * *

## 3\. Common Options

| Option | Description |
| --- | --- |
| `-A` | Check all filesystems in `/etc/fstab` |
| `-N` | Show what would be done, but do not execute |
| `-P` | Parallel check (check multiple filesystems simultaneously) |
| `-R` | Skip the root filesystem when used with `-A` |
| `-V` | Verbose mode |
| `-y` | Automatically answer 'yes' to all prompts (fix errors automatically) |
| `-n` | Answer 'no' to all prompts (do not fix errors) |
| `-f` | Force check, even if filesystem seems clean |
| `-C 0` | Show progress during check |

* * *

## 4\. Checking a Single Partition

```bash
sudo fsck /dev/sda1
```

- Prompts for fixes if errors are found.
    
- Use `-y` to fix automatically:
    

```bash
sudo fsck -y /dev/sda1
```

* * *

## 5\. Checking All Partitions in `/etc/fstab`

```bash
sudo fsck -A
```

- Add `-y` to fix all automatically:

```bash
sudo fsck -Ay
```

- Skip root partition if needed:

```bash
sudo fsck -AR
```

* * *

## 6\. Advanced Options

- **Force check even if clean:**

```bash
sudo fsck -f /dev/sda1
```

- **Check with verbose output and progress:**

```bash
sudo fsck -CV0 /dev/sda1
```

- **Simulate check without making changes:**

```bash
sudo fsck -N /dev/sda1
```

* * *

## 7\. Notes for Specific Filesystems

- **ext2/ext3/ext4:** Use `fsck` directly. Ext4 also supports `e2fsck` (equivalent).
    
- **xfs:** Use `xfs_repair` instead of `fsck`.
    
- **swap partitions:** Do not run `fsck`.
    

* * *

## 8\. Example Workflow

```bash
# 1. Unmount the partition first
sudo umount /dev/sda1

# 2. Check and repair errors
sudo fsck -y /dev/sda1

# 3. Check all filesystems in fstab
sudo fsck -A

# 4. Check with verbose output and progress
sudo fsck -CV0 /dev/sda1
```

* * *

## 9\. Tips and Warnings

1.  **Backup important data** before running fsck on critical partitions.
    
2.  **Do not run fsck on a mounted partition** (except read-only checks).
    
3.  Use `-y` for automatic repair when unattended.
    
4.  For **xfs filesystems**, always use `xfs_repair`.
    
5.  Run fsck after improper shutdowns, power failures, or suspected disk corruption.
    
6.  Use `fsck -N` to simulate before actual repair if unsure.
    

* * *

# `tune2fs` Command in Linux

`tune2fs` is a Linux command-line utility used to **adjust tunable parameters of ext2, ext3, and ext4 filesystems**. Unlike `mkfs`, it does not create filesystems, but allows you to **modify existing ones**.

* * *

## 1\. What is `tune2fs`?

- Modify ext2/ext3/ext4 filesystem parameters without formatting.
    
- Change parameters like **volume label, reserved blocks, mount count, check intervals**.
    
- Useful for filesystem optimization and maintenance.
    
- Requires **root privileges**.
    

* * *

## 2\. Syntax

```bash
sudo tune2fs [options] <device>
```

- `<device>`: Partition or disk, e.g., `/dev/sda1`

Example:

```bash
sudo tune2fs -L Data /dev/sda1
```

* * *

## 3\. Common Options

| Option | Description |
| --- | --- |
| `-l` | List filesystem superblock information |
| `-L <label>` | Set or change the filesystem label |
| `-m <percentage>` | Set reserved blocks for root |
| `-i <interval>` | Set maximum mount count or time interval for check (`m`, `d`, `w`) |
| `-c <count>` | Set maximum mount count before fsck check |
| `-C <count>` | Change the mount count manually |
| `-e` | Errors behavior (continue, remount-ro, panic) |
| `-E <extended-options>` | Extended tunable options (stride, stripe-width, etc.) |
| `-j` | Enable journaling (convert ext2 to ext3) |
| `-O <feature>` | Enable/disable filesystem features |

* * *

## 4\. Viewing Filesystem Info

```bash
sudo tune2fs -l /dev/sda1
```

- Displays info like filesystem volume name, block count, block size, mount count, last checked, features, reserved blocks, etc.

Example output:

```
Filesystem volume name:   Data
Last mounted on:          /mnt/data
Filesystem UUID:          1234-5678
Filesystem magic number:  0xEF53
Filesystem state:         clean
Errors behavior:          Continue
Mount count:              3
Maximum mount count:      20
Last checked:             Mon Jan 20 2026
Reserved blocks uid:      0
Reserved blocks gid:      0
Reserved block count:     1024
```

* * *

## 5\. Changing Volume Label

```bash
sudo tune2fs -L MyData /dev/sda1
```

- Sets the filesystem label to `MyData`.

* * *

## 6\. Adjusting Reserved Blocks

Reserved blocks are space reserved for root (default 5%).

```bash
# Set reserved blocks to 1%
sudo tune2fs -m 1 /dev/sda1
```

* * *

## 7\. Setting Maximum Mount Count & Check Interval

```bash
# Set maximum mount count before fsck: 30
sudo tune2fs -c 30 /dev/sda1

# Set check interval to 90 days
sudo tune2fs -i 90d /dev/sda1
```

- `-c <count>` → Max mount count before fsck.
    
- `-i <interval>` → Time interval before fsck (`d`\=days, `m`\=months, `w`\=weeks).
    

* * *

## 8\. Adjusting Errors Behavior

```bash
# Set errors to remount read-only
sudo tune2fs -e remount-ro /dev/sda1
```

- Options: `continue`, `remount-ro`, `panic`

* * *

## 9\. Enabling Filesystem Features

```bash
# Enable journaling (convert ext2 to ext3)
sudo tune2fs -j /dev/sda1

# Enable features like extents, 64bit
sudo tune2fs -O extents,64bit /dev/sda1
```

* * *

## 10\. Example Workflow

```bash
# 1. View filesystem info
sudo tune2fs -l /dev/sda1

# 2. Change volume label
sudo tune2fs -L Backup /dev/sda1

# 3. Set reserved blocks to 1%
sudo tune2fs -m 1 /dev/sda1

# 4. Set max mount count to 30
sudo tune2fs -c 30 /dev/sda1

# 5. Set check interval to 90 days
sudo tune2fs -i 90d /dev/sda1

# 6. Change errors behavior
sudo tune2fs -e remount-ro /dev/sda1
```

* * *

## 11\. Tips and Warnings

1.  **Backup important data** before modifying filesystem parameters.
    
2.  `tune2fs` works **only on ext2/ext3/ext4** filesystems.
    
3.  Avoid changing features on a mounted filesystem unless supported.
    
4.  Use `tune2fs -l` frequently to verify changes.
    
5.  Reserved blocks help prevent full filesystem crashes for root processes.
    

* * *

* * *

# `dumpe2fs` Command in Linux

`dumpe2fs` is a Linux command-line utility used to **display detailed information about ext2, ext3, and ext4 filesystems**. It reads the **superblock and block group information** of a filesystem.

* * *

## 1\. What is `dumpe2fs`?

- Provides **filesystem metadata**, not actual files.
    
- Useful for **diagnostics, monitoring, and troubleshooting**.
    
- Requires **root privileges** to access raw device data.
    
- Works only with **ext2/ext3/ext4** filesystems.
    

* * *

## 2\. Syntax

```bash
sudo dumpe2fs [options] <device>
```

- `<device>`: Partition or disk, e.g., `/dev/sda1`

Example:

```bash
sudo dumpe2fs /dev/sda1
```

* * *

## 3\. Common Options

| Option | Description |
| --- | --- |
| `-h` | Display only the superblock information (summary) |
| `-b <block>` | Display information about a specific block group |
| `-f` | Force display even if filesystem is mounted |
| `-V` | Show version information |
| `-p` | Pretty print (more readable format) |

* * *

## 4\. Viewing Superblock Information

```bash
sudo dumpe2fs -h /dev/sda1
```

- Displays key information like:
    
    - Filesystem volume name
        
    - Last mounted path
        
    - UUID
        
    - Filesystem state (clean/dirty)
        
    - Block count, block size, inode count
        
    - Reserved blocks
        
    - Maximum mount count and last checked time
        

Example output:

```
Filesystem volume name:   Data
Last mounted on:          /mnt/data
Filesystem UUID:          1234-5678
Filesystem magic number:  0xEF53
Filesystem state:         clean
Errors behavior:          Continue
Mount count:              3
Maximum mount count:      20
Last checked:             Mon Jan 20 2026
Reserved blocks uid:      0
Reserved blocks gid:      0
Reserved block count:     1024
Block size:               4096
Fragment size:            4096
Inode count:              32768
Free blocks:              30000
Free inodes:              32000
```

* * *

## 5\. Viewing Detailed Block Group Info

```bash
sudo dumpe2fs /dev/sda1
```

- Displays info for each block group:
    
    - Block bitmap, inode bitmap, inode table
        
    - Free blocks, free inodes
        
    - Number of directories
        
- Useful for **troubleshooting space or inode issues**.
    

* * *

## 6\. Example Workflow

```bash
# 1. Check superblock information
sudo dumpe2fs -h /dev/sda1

# 2. Display detailed information
sudo dumpe2fs /dev/sda1

# 3. Display info about block group 0
sudo dumpe2fs -b 0 /dev/sda1
```

* * *

## 7\. Tips and Warnings

1.  **Do not modify filesystems with dumpe2fs** — it is read-only.
    
2.  Must have **root privileges** for raw device access.
    
3.  Ideal for **troubleshooting corruption, checking reserved blocks, mount counts, and filesystem features**.
    
4.  Combine with `tune2fs` to make adjustments if needed.
    
5.  Use `-h` for a quick summary instead of long output.
    

* * *

* * *
