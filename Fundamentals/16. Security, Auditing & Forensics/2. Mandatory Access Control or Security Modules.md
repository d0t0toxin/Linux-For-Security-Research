***
**Mandatory Access Control / Security Modules:** `selinuxenabled`, `getenforce`, `setenforce`, `semanage`, `aa-status`, `apparmor_status`, `aa-complain`, `aa-enforce`
***
***
# `selinuxenable` Command in Linux

## Overview

The `selinuxenabled` command is a simple utility in Linux used to check whether SELinux (Security-Enhanced Linux) is enabled on the system. It provides a quick way for scripts and administrators to conditionally perform actions based on SELinux status.

## Syntax

`selinuxenabled`

## Description

- `selinuxenabled` checks the current status of SELinux.
    
- The command returns no output but sets the exit status to indicate the SELinux state.
    
- It is commonly used in shell scripts for conditional execution.
    

## Exit Status

- Exit status `0` indicates SELinux is enabled.
    
- Exit status `1` indicates SELinux is disabled.
    
- Exit status `2` indicates an error occurred while checking SELinux status.
    

## Options

The `selinuxenabled` command does not have any options or arguments. Its sole purpose is to check the SELinux status.

## Examples

### Example 1 Checking SELinux status

```
selinuxenabled
```

- No output will be displayed.
    
- Check the exit status to determine SELinux status:
    

```
if selinuxenabled; then
    echo SELinux is enabled
else
    echo SELinux is disabled
fi
```

### Example 2 Using in scripts

```
#!/bin/bash

if selinuxenabled; then
    echo Applying SELinux-specific configurations
    # Insert SELinux-specific commands here
else
    echo SELinux is not active
fi
```

### Example 3 Checking SELinux status using the exit code directly

```
selinuxenabled
STATUS=$?
if [ $STATUS -eq 0 ]; then
    echo SELinux enabled
elif [ $STATUS -eq 1 ]; then
    echo SELinux disabled
else
    echo Error checking SELinux status
fi
```

## Notes

- `selinuxenabled` is a part of the `policycoreutils` package. Make sure it is installed on your system.
    
- It does not provide verbose output; it is intended for use in scripts.
    
- For more detailed information on SELinux status, use `getenforce` or `sestatus`.
    

* * *

* * *

# `getenforce` Command in Linux

## Overview

The `getenforce` command in Linux is used to display the current mode of SELinux (Security-Enhanced Linux). It provides administrators with a simple way to determine whether SELinux is enforcing, permissive, or disabled.

## Syntax

getenforce

## Description

- `getenforce` outputs the current SELinux mode.
    
- It is primarily used to quickly check SELinux status without interpreting policy details.
    
- Useful in scripts or system administration tasks to conditionally perform actions based on SELinux mode.
    

## SELinux Modes

- Enforcing: SELinux security policy is enforced.
    
- Permissive: SELinux prints warnings instead of enforcing policy.
    
- Disabled: SELinux is completely turned off.
    

## Options

The `getenforce` command does not have any options or arguments. Its sole function is to return the current SELinux mode.

## Examples

### Example 1 Checking current SELinux mode

```
getenforce
```

- This will output one of the following: Enforcing, Permissive, Disabled

### Example 2 Using in shell scripts

```
#!/bin/bash
MODE=$(getenforce)
if [ "$MODE" = "Enforcing" ]; then
    echo SELinux is enforcing policy
elif [ "$MODE" = "Permissive" ]; then
    echo SELinux is in permissive mode
else
    echo SELinux is disabled
fi
```

### Example 3 Conditional execution based on SELinux mode

```
if [ "$(getenforce)" = "Enforcing" ]; then
    echo Configuring firewall rules compatible with SELinux
fi
```

## Notes

- `getenforce` is part of the `policycoreutils` package.
    
- It provides only the current mode and does not show detailed SELinux policy information.
    
- For detailed SELinux status including policy enforcement, use `sestatus`.
    

* * *

* * *

# `setenforce` Command in Linux

## Overview

The `setenforce` command in Linux is used to change the mode of SELinux (Security-Enhanced Linux) at runtime. It allows administrators to switch between enforcing and permissive modes without rebooting the system.

## Syntax

setenforce \[Enforcing | Permissive | 1 | 0\]

## Description

- `setenforce` modifies the current SELinux mode.
    
- Enabling Enforcing mode will actively enforce SELinux policies.
    
- Enabling Permissive mode will log policy violations but not enforce them.
    
- Requires root privileges to execute.
    

## SELinux Modes

- Enforcing or 1: SELinux policy is enforced.
    
- Permissive or 0: SELinux policy is not enforced but violations are logged.
    

## Options

The command accepts the following options:

- Enforcing: Switches SELinux to enforcing mode.
    
- Permissive: Switches SELinux to permissive mode.
    
- 1: Equivalent to Enforcing.
    
- 0: Equivalent to Permissive.
    

## Examples

### Example 1 Switching to enforcing mode

```
sudo setenforce Enforcing
```

- Changes SELinux mode to enforcing immediately.

### Example 2 Switching to permissive mode

```
sudo setenforce Permissive
```

- Changes SELinux mode to permissive immediately.

### Example 3 Using numeric values

```
sudo setenforce 1   # Sets mode to enforcing
sudo setenforce 0   # Sets mode to permissive
```

### Example 4 Checking the result

```
getenforce
```

- Confirms the current SELinux mode after using `setenforce`.

### Example 5 Using in scripts

```
#!/bin/bash

# Switch to permissive mode temporarily
sudo setenforce 0

# Perform tasks that require permissive mode
# Insert commands here

# Return to enforcing mode
sudo setenforce 1
```

## Notes

- `setenforce` changes the SELinux mode only until the next reboot.
    
- To make permanent changes, modify `/etc/selinux/config`.
    
- Attempting to change SELinux mode without root privileges will fail.
    

* * *

* * *

# `semanage` Command in Linux

## Overview

The `semanage` command in Linux is used to manage SELinux (Security-Enhanced Linux) policy components. It allows administrators to configure and manage SELinux policy without directly editing policy files, including file contexts, ports, booleans, and user mappings.

## Syntax

semanage \[options\] \[subcommand\] \[arguments\]

## Description

- `semanage` provides a higher-level interface to modify SELinux policies.
    
- Changes made using `semanage` are persistent across reboots.
    
- Requires root privileges to execute most operations.
    

## Common Subcommands and Usage

### 1\. Managing File Contexts

- Add a new file context:

```
semanage fcontext -a -t type '/path(/.*)?'
```

- Example:

```
semanage fcontext -a -t httpd_sys_content_t '/var/www/html(/.*)?'
```

- Apply the changes:

```
restorecon -Rv /var/www/html
```

- List existing file contexts:

```
semanage fcontext -l
```

- Modify a file context:

```
semanage fcontext -m -t type '/path'
```

- Delete a file context:

```
semanage fcontext -d '/path'
```

### 2\. Managing Ports

- Add a port for a service:

```
semanage port -a -t type -p protocol port_number
```

- Example:

```
semanage port -a -t http_port_t -p tcp 8080
```

- Delete a port:

```
semanage port -d -t type -p protocol port_number
```

- List all SELinux port mappings:

```
semanage port -l
```

### 3\. Managing Booleans

- List all SELinux booleans:

```
semanage boolean -l
```

- Enable a boolean:

```
setsebool -P boolean_name on
```

- Disable a boolean:

```
setsebool -P boolean_name off
```

### 4\. Managing SELinux Users

- Map a Linux user to an SELinux user:

```
semanage login -a -s SELinux_user linux_user
```

- Modify an existing mapping:

```
semanage login -m -s SELinux_user linux_user
```

- Delete a mapping:

```
semanage login -d linux_user
```

- List all mappings:

```
semanage login -l
```

### 5\. Managing Modules

- List SELinux modules:

```
semanage module -l
```

- Delete a module:

```
semanage module -d module_name
```

## Notes

- `semanage` is part of the `policycoreutils-python-utils` package.
    
- Many operations with `semanage` require root privileges.
    
- Changes made using `semanage` are persistent and do not require a reboot.
    
- For temporary changes, other commands like `setenforce` or `restorecon` may be more appropriate.
    

* * *

* * *

# `aa-status` Command in Linux

## Overview

The `aa-status` command in Linux is used to display the current status of AppArmor, a Mandatory Access Control (MAC) system. It provides information on which AppArmor profiles are loaded, enforced, or in complain mode.

## Syntax

aa-status \[options\]

## Description

- `aa-status` reports the current AppArmor status.
    
- Shows the number of loaded profiles, profiles in enforce mode, and profiles in complain mode.
    
- Displays information about processes that are confined by AppArmor.
    
- Useful for system administrators to verify AppArmor enforcement and profile activity.
    

## Options

- `-h` or `--help`: Display help message and exit.
    
- `-v` or `--verbose`: Show detailed information about profiles and processes.
    
- `--profiles`: Display a list of loaded profiles.
    
- `--complain`: Display profiles in complain mode.
    
- `--enforce`: Display profiles in enforce mode.
    
- `--modules`: Show the loaded AppArmor kernel modules.
    

## Examples

### Example 1 Display basic AppArmor status

```
aa-status
```

- Shows total number of profiles, enforced profiles, complain profiles, and processes in each mode.

### Example 2 Display detailed information

```
aa-status -v
```

- Provides verbose information including individual profile details and associated processes.

### Example 3 List profiles in enforce mode

```
aa-status --enforce
```

- Shows only the profiles currently enforced.

### Example 4 List profiles in complain mode

```
aa-status --complain
```

- Shows only the profiles currently in complain mode.

### Example 5 Display loaded profiles only

```
aa-status --profiles
```

- Lists all loaded AppArmor profiles without additional status information.

### Example 6 Check AppArmor kernel modules

```
aa-status --modules
```

- Displays the AppArmor kernel modules that are currently loaded.

## Notes

- `aa-status` requires root privileges to display information about all profiles and processes.
    
- It is part of the `apparmor-utils` package.
    
- Useful for troubleshooting AppArmor-related access denials and verifying security policy enforcement.
    

* * *

* * *

# `apparmor_status` Command in Linux

## Overview

The `apparmor_status` command in Linux is used to report the current status of the AppArmor security framework. It provides detailed information about loaded profiles, enforcement modes, and processes confined by AppArmor.

## Syntax

apparmor_status \[options\]

## Description

- `apparmor_status` displays the current AppArmor status including the number of loaded profiles, profiles in enforce mode, and profiles in complain mode.
    
- It also lists processes that are confined by AppArmor and their respective profile status.
    
- Useful for system administrators to monitor and troubleshoot AppArmor policies.
    

## Options

- `-h` or `--help`: Display the help message and exit.
    
- `-v` or `--verbose`: Show detailed information including each profile and associated processes.
    
- `--profiles`: List all loaded AppArmor profiles.
    
- `--enforce`: Show profiles currently in enforce mode.
    
- `--complain`: Show profiles currently in complain mode.
    
- `--modules`: Display loaded AppArmor kernel modules.
    

## Examples

### Example 1 Display basic AppArmor status

```
apparmor_status
```

- Provides a summary of total profiles, enforced profiles, complain profiles, and processes.

### Example 2 Display detailed information

```
apparmor_status -v
```

- Displays verbose information including individual profile details and associated processes.

### Example 3 List profiles in enforce mode

```
apparmor_status --enforce
```

- Lists only the profiles currently enforced.

### Example 4 List profiles in complain mode

```
apparmor_status --complain
```

- Lists only the profiles currently in complain mode.

### Example 5 List all loaded profiles

```
apparmor_status --profiles
```

- Shows all loaded AppArmor profiles without additional status information.

### Example 6 Display loaded kernel modules

```
apparmor_status --modules
```

- Displays the AppArmor kernel modules currently loaded.

## Notes

- `apparmor_status` may require root privileges to display information about all profiles and processes.
    
- It is part of the `apparmor-utils` package.
    
- Useful for verifying AppArmor policy enforcement and troubleshooting access denials.
    

* * *

* * *

# `aa-complain` Command in Linux

## Overview

The `aa-complain` command in Linux is used to change the mode of an AppArmor profile to complain mode. In this mode, policy violations are logged but not enforced, which helps administrators test and debug profiles without restricting program operations.

## Syntax

aa-complain \[options\] profile

## Description

- `aa-complain` sets the specified AppArmor profile to complain mode.
    
- In complain mode, AppArmor allows all actions but logs any policy violations.
    
- Useful for testing and tuning AppArmor profiles before enforcing them.
    
- Requires root privileges to modify profile modes.
    

## Options

- `-h` or `--help`: Display help information.
    
- `-v` or `--verbose`: Show detailed output including the profile being modified.
    
- `-r` or `--replace`: Replace an existing profile with the same name while setting it to complain mode.
    

## Examples

### Example 1 Set a profile to complain mode

```
aa-complain /usr/bin/myapp
```

- Changes the AppArmor profile for `/usr/bin/myapp` to complain mode.

### Example 2 Use verbose output

```
aa-complain -v /usr/bin/myapp
```

- Displays detailed information about the operation and confirms the profile change.

### Example 3 Replace an existing profile and set to complain mode

```
aa-complain -r /usr/bin/myapp
```

- Replaces the existing profile for `/usr/bin/myapp` and sets it to complain mode.

### Example 4 Check status after changing profile

```
aa-status --complain
```

- Confirms that the profile `/usr/bin/myapp` is now in complain mode.

### Example 5 Using in scripts

```
#!/bin/bash

PROFILE=/usr/bin/myapp

# Set profile to complain mode for testing
sudo aa-complain $PROFILE

# Perform operations to generate logs
# Insert testing commands here

# Optional: Return to enforce mode
sudo aa-enforce $PROFILE
```

## Notes

- Changing a profile to complain mode does not enforce restrictions, only logs violations.
    
- `aa-complain` is part of the `apparmor-utils` package.
    
- Useful for debugging new profiles or modifying existing profiles without disrupting system operations.
    

* * *

* * *

# `aa-enforce` Command in Linux

## Overview

The `aa-enforce` command in Linux is used to set an AppArmor profile to enforce mode. In enforce mode, the security policies defined by the profile are actively applied, restricting the actions of the confined program according to the rules.

## Syntax

aa-enforce \[options\] profile

## Description

- `aa-enforce` changes the specified AppArmor profile from complain mode to enforce mode.
    
- In enforce mode, any action that violates the profile rules is blocked and logged.
    
- Requires root privileges to modify profile modes.
    
- Useful for activating fully tested and tuned profiles for security enforcement.
    

## Options

- `-h` or `--help`: Display help information.
    
- `-v` or `--verbose`: Show detailed output including the profile being modified.
    
- `-r` or `--replace`: Replace an existing profile with the same name while setting it to enforce mode.
    

## Examples

### Example 1 Set a profile to enforce mode

```
aa-enforce /usr/bin/myapp
```

- Changes the AppArmor profile for `/usr/bin/myapp` to enforce mode.

### Example 2 Use verbose output

```
aa-enforce -v /usr/bin/myapp
```

- Displays detailed information about the operation and confirms the profile change.

### Example 3 Replace an existing profile and set to enforce mode

```
aa-enforce -r /usr/bin/myapp
```

- Replaces the existing profile for `/usr/bin/myapp` and sets it to enforce mode.

### Example 4 Check status after changing profile

```
aa-status --enforce
```

- Confirms that the profile `/usr/bin/myapp` is now in enforce mode.

### Example 5 Using in scripts

```
#!/bin/bash

PROFILE=/usr/bin/myapp

# Set profile to enforce mode
sudo aa-enforce $PROFILE

# Profile now actively enforces rules
# Insert commands to run the application
```

## Notes

- Setting a profile to enforce mode activates all restrictions defined in the profile.
    
- `aa-enforce` is part of the `apparmor-utils` package.
    
- Recommended to test profiles in complain mode before switching to enforce mode.
    

* * *

* * *
