***
**Permissions & Access Auditing:** `getfacl`, `setfacl`, `auditctl`, `ausearch`, `auditd`
***
***
# `getfacl` command in Linux

This document explains everything about the getfacl command in Linux. It includes what it is, how it works, all options, and clear examples. The language is simple and practical so you can copy and reuse it easily.

* * *

## What is getfacl

getfacl stands for get file access control list.

It is used to view Access Control Lists (ACLs) of files and directories.

ACLs allow more fine grained permissions than standard Linux permissions (owner, group, others).

With ACLs, you can give specific users or groups custom permissions on a file or directory.

* * *

## Why ACLs are needed

Traditional permissions allow only:

- One owner
- One group
- Others

ACLs allow:

- Multiple users with different permissions
- Multiple groups with different permissions

* * *

## Basic syntax

```
getfacl [options] file_or_directory
```

You can specify one or more files or directories.

* * *

## Basic example

```
getfacl file.txt
```

Sample output:

```
# file: file.txt
# owner: sushil
# group: users
user::rw-
group::r--
other::r--
```

Explanation:

- user is the file owner permissions
- group is the group permissions
- other is everyone else

* * *

## Example with ACL entries

```
getfacl project.txt
```

Output:

```
# file: project.txt
# owner: sushil
# group: dev
user::rw-
user:ram:r--
group::r--
mask::r--
other::---
```

Explanation:

- user:ram:r-- means user ram has read access
- mask limits the maximum permission for named users and groups

* * *

## All getfacl options

Below are all commonly available options for getfacl.

* * *

### \-a or --access

Show file access ACL only. This is the default behavior.

Example:

```
getfacl -a file.txt
```

* * *

### \-d or --default

Show default ACLs only. Default ACLs apply to directories and are inherited by new files.

Example:

```
getfacl -d mydir
```

* * *

### \-c or --omit-header

Do not display the comment header (file name, owner, group).

Example:

```
getfacl -c file.txt
```

Output:

```
user::rw-
group::r--
other::r--
```

* * *

### \-e or --all-effective

Print effective permissions instead of raw permissions.

Useful when mask is applied.

Example:

```
getfacl -e project.txt
```

* * *

### \-E or --no-effective

Do not print effective permission comments.

Example:

```
getfacl -E project.txt
```

* * *

### \-p or --physical

Show ACLs of the symbolic link itself, not the target.

Example:

```
getfacl -p mylink
```

* * *

### \-L or --logical

Follow symbolic links and show ACLs of the target file.

This is the default behavior.

Example:

```
getfacl -L mylink
```

* * *

### \-R or --recursive

Recursively list ACLs of all files and directories.

Example:

```
getfacl -R mydir
```

* * *

### \-t or --tabular

Use tabular output format.

Example:

```
getfacl -t file.txt
```

* * *

### \--absolute-names

Do not remove leading slash from absolute paths.

Example:

```
getfacl --absolute-names /home/sushil/file.txt
```

* * *

### \--version

Display getfacl version information.

Example:

```
getfacl --version
```

* * *

### \--help

Display help information.

Example:

```
getfacl --help
```

* * *

## Understanding ACL fields

### user

```
user::rw-
```

Permissions for file owner.

* * *

### named user

```
user:ram:r--
```

Permissions for a specific user.

* * *

### group

```
group::r--
```

Permissions for file group.

* * *

### named group

```
group:dev:rw-
```

Permissions for a specific group.

* * *

### mask

```
mask::r--
```

Maximum effective permissions for named users and groups.

* * *

### other

```
other::---
```

Permissions for everyone else.

* * *

## Default ACLs

Default ACLs are set on directories.

They apply automatically to newly created files and directories inside that directory.

View default ACL:

```
getfacl -d mydir
```

* * *

## getfacl with multiple files

```
getfacl file1 file2 file3
```

* * *

## getfacl with find command

```
find mydir -type f -exec getfacl {} \;
```

* * *

## getfacl vs ls -l

ls -l shows basic permissions only.

getfacl shows full ACL information.

If a plus sign appears in ls -l output, it means ACLs are present.

Example:

```
-rw-r--r--+ 1 sushil users 100 file.txt
```

* * *

## Common use cases

- Audit file permissions
- Debug permission issues
- Verify ACL inheritance
- Security reviews

* * *

## Related commands

- setfacl to set or modify ACLs
- ls to view basic permissions
- chmod to change standard permissions

* * *

## Summary

getfacl is used to read ACLs.

It helps you understand advanced Linux permission setups.

It is essential when working with multi user systems and shared directories.

* * *

* * *

# `setfacl` command in Linux

This document explains everything about the setfacl command in Linux. It includes what it is, why it is used, all options, and many clear examples. The content is simple and easy to copy.

* * *

## What is setfacl

setfacl stands for set file access control lists.

Linux normally uses permissions like read, write, and execute for owner, group, and others. ACLs allow you to give permissions to specific users or groups beyond those basic permissions.

setfacl is used to create, modify, and remove ACLs on files and directories.

* * *

## When to use setfacl

Use setfacl when

- You need to give a specific user access to a file without changing ownership
    
- Multiple users need different permissions on the same file
    
- Default permissions on directories are not enough
    

* * *

## Basic syntax

```
setfacl [options] [acl_spec] file_or_directory
```

* * *

## ACL entry format

An ACL entry looks like this

```
type:name:permissions
```

Types

- u for user
    
- g for group
    
- o for others
    
- m for mask
    
- d for default ACL
    

Permissions

- r for read
    
- w for write
    
- x for execute
    

Examples

- u:sushil:rw
    
- g:developers:r
    

* * *

## Important rule about mask

The mask limits the effective permissions for all named users and groups.

If a user has rw but mask is r, the user only gets r.

* * *

## Common options of setfacl

### \-m or --modify

Modify or add ACL entries.

Example

```
setfacl -m u:ram:r file.txt
```

* * *

### \-x or --remove

Remove specific ACL entries.

Example

```
setfacl -x u:ram file.txt
```

* * *

### \-b or --remove-all

Remove all ACL entries except the basic owner, group, and others.

Example

```
setfacl -b file.txt
```

* * *

### \-k or --remove-default

Remove only default ACLs from a directory.

Example

```
setfacl -k mydir
```

* * *

### \-d or --default

Set default ACLs on directories. These apply to new files created inside.

Example

```
setfacl -d -m u:ram:rw mydir
```

* * *

### \-R or --recursive

Apply ACLs recursively to all files and directories.

Example

```
setfacl -R -m g:devs:rw mydir
```

* * *

### \-L or --logical

Follow symbolic links during recursive operations.

Example

```
setfacl -R -L -m u:ram:r mydir
```

* * *

### \-P or --physical

Do not follow symbolic links. This is the default behavior.

Example

```
setfacl -R -P -m u:ram:r mydir
```

* * *

### \--restore

Restore ACLs from a backup file created by getfacl.

Example

```
setfacl --restore=backup.acl
```

* * *

### \--test

Test the command without actually changing ACLs.

Example

```
setfacl --test -m u:ram:rw file.txt
```

* * *

### \-n or --no-mask

Do not recalculate the mask entry.

Example

```
setfacl -n -m u:ram:rw file.txt
```

* * *

### \-e or --edit

Edit ACLs using a text editor.

Example

```
setfacl -e file.txt
```

* * *

### \-M or --modify-file

Read ACL entries from a file and apply them.

Example

```
setfacl -M acl_rules.txt file.txt
```

* * *

### \-X or --remove-file

Remove ACL entries listed in a file.

Example

```
setfacl -X remove_rules.txt file.txt
```

* * *

### \-h or --help

Show help information.

Example

```
setfacl --help
```

* * *

### \-v or --version

Show version information.

Example

```
setfacl --version
```

* * *

## Practical examples

### Give a user read access to a file

```
setfacl -m u:ram:r notes.txt
```

* * *

### Give a group read and write access

```
setfacl -m g:staff:rw report.txt
```

* * *

### Set default ACLs on a directory

```
setfacl -d -m g:staff:rw project
```

* * *

### Remove ACL for a user

```
setfacl -x u:ram file.txt
```

* * *

### Remove all ACLs from a file

```
setfacl -b file.txt
```

* * *

### Copy ACLs from one file to another

```
getfacl file1 | setfacl --set-file=- file2
```

* * *

## Check ACLs

Use getfacl to view ACLs.

```
getfacl file.txt
```

* * *

## Notes and tips

- ACLs require a filesystem that supports them like ext4 or xfs
    
- Backup ACLs before making large changes
    
- Always remember the mask affects real permissions
    

* * *

## Summary

setfacl is a powerful command to control fine grained permissions in Linux. It allows precise access control beyond traditional permissions and is essential for multi user systems.

* * *

* * *

# `auditctl` command in Linux complete guide

This document explains everything about the auditctl command in Linux. It covers what it is, why it is used, all options, and clear examples. The language is simple and easy to copy.

* * *

## What is auditctl

auditctl is a command used to control the Linux Audit subsystem.

The Linux Audit system records security relevant events such as file access, command execution, system calls, and permission changes.

auditctl is mainly used by system administrators for security monitoring, compliance, and troubleshooting.

* * *

## Audit system components

- auditd is the audit daemon that logs events
    
- auditctl manages audit rules
    
- ausearch searches audit logs
    
- aureport creates audit reports
    

* * *

## Basic syntax

```
auditctl [options]
```

Rules added using auditctl are temporary and lost after reboot unless saved in audit rules files.

* * *

## Types of audit rules

- File and directory watch rules
    
- System call rules
    
- Task and process rules
    
- Control rules
    

* * *

## File and directory watch rules

Used to monitor access to files or directories.

Basic format

```
auditctl -w path -p permissions -k keyname
```

Permissions

- r for read
    
- w for write
    
- x for execute
    
- a for attribute change
    

* * *

## System call rules

Used to monitor system calls.

Basic format

```
auditctl -a action,list -S syscall -F field=value -k keyname
```

* * *

## Common auditctl options

### \-w

Add a watch on a file or directory.

Example

```
auditctl -w /etc/passwd -p wa -k passwd_changes
```

* * *

### \-p

Specify permissions to watch.

Example

```
auditctl -w /etc/shadow -p r -k shadow_read
```

* * *

### \-k

Add a key name to identify audit records.

Example

```
auditctl -w /var/log/secure -p wa -k log_monitor
```

* * *

### \-a

Add a system call rule.

Example

```
auditctl -a always,exit -S open -k file_open
```

* * *

### \-A

Append a system call rule.

Example

```
auditctl -A always,exit -S unlink -k file_delete
```

* * *

### \-d

Delete a specific rule.

Example

```
auditctl -d -w /etc/passwd
```

* * *

### \-D

Delete all audit rules.

Example

```
auditctl -D
```

* * *

### \-l

List all current audit rules.

Example

```
auditctl -l
```

* * *

### \-s

Show audit system status.

Example

```
auditctl -s
```

* * *

### \-e

Enable or disable auditing.

Values

- 0 disable auditing
    
- 1 enable auditing
    
- 2 lock auditing
    

Example

```
auditctl -e 1
```

* * *

### \-f

Set failure mode when audit daemon fails.

Values

- 0 silent
    
- 1 print message
    
- 2 panic system
    

Example

```
auditctl -f 1
```

* * *

### \-r

Set the audit backlog rate limit.

Example

```
auditctl -r 100
```

* * *

### \-b

Set the audit backlog buffer size.

Example

```
auditctl -b 8192
```

* * *

### \-S

Specify a system call name.

Example

```
auditctl -a always,exit -S execve -k command_exec
```

* * *

### \-F

Add a field filter to a rule.

Common fields

- uid user id
    
- gid group id
    
- pid process id
    
- auid audit user id
    
- path file path
    
- arch system architecture
    

Example

```
auditctl -a always,exit -S open -F uid=1000 -k user_open
```

* * *

### \-C

Add a comparison condition.

Example

```
auditctl -a always,exit -S chmod -C uid!=euid -k perm_change
```

* * *

### \-m

Send a message to the audit log.

Example

```
auditctl -m system audit started
```

* * *

### \-R

Load audit rules from a file.

Example

```
auditctl -R rules.conf
```

* * *

### \--loginuid-immutable

Make loginuid immutable.

Example

```
auditctl --loginuid-immutable
```

* * *

### \-h or --help

Display help information.

Example

```
auditctl --help
```

* * *

### \-v or --version

Show version information.

Example

```
auditctl --version
```

* * *

## Practical examples

### Monitor changes to passwd file

```
auditctl -w /etc/passwd -p wa -k passwd
```

* * *

### Monitor all command executions

```
auditctl -a always,exit -S execve -k exec_monitor
```

* * *

### Monitor file deletion

```
auditctl -a always,exit -S unlink -S unlinkat -k delete
```

* * *

### Monitor permission changes

```
auditctl -a always,exit -S chmod -S chown -k perm_change
```

* * *

### Remove all audit rules

```
auditctl -D
```

* * *

## View audit logs

Audit logs are stored in

```
/var/log/audit/audit.log
```

Use ausearch to search logs.

* * *

## Important notes

- auditctl rules are not persistent after reboot
    
- Use audit rules files for permanent rules
    
- Too many rules can affect system performance
    

* * *

## Summary

auditctl is a powerful security tool used to monitor system activity in Linux. It helps detect unauthorized access, track changes, and meet security compliance requirements.

* * *

* * *

# `ausearch` Command in Linux

`ausearch` is a command-line utility in Linux used to search audit logs generated by `auditd`. It allows filtering events based on various criteria such as time, event type, user, etc.

* * *

## Basic Syntax

```
ausearch [OPTIONS]
```

* * *

## Common Options and Examples

### 1\. Search by Event ID

```
ausearch -a 1234
```

Searches for audit events with the specified event ID `1234`.

### 2\. Search by User ID

```
ausearch -ua 1001
```

Searches for events performed by user ID `1001`.

### 3\. Search by Group ID

```
ausearch -ga 100
```

Searches for events performed by group ID `100`.

### 4\. Search by Login UID

```
ausearch -lu 1001
```

Searches for events associated with the login UID `1001`.

### 5\. Search by Executable Path

```
ausearch -x /usr/bin/vim
```

Searches for events generated by executing `/usr/bin/vim`.

### 6\. Search by System Call

```
ausearch -sc open
```

Searches for audit events involving the `open` system call.

### 7\. Search by Message Type

```
ausearch -m USER_LOGIN
```

Searches for events of message type `USER_LOGIN`.

### 8\. Search by Key

```
ausearch -k mykey
```

Searches for events tagged with the key `mykey` in audit rules.

### 9\. Search by Time

```
ausearch -ts today
ausearch -ts 2026-01-24 00:00:00 -te 2026-01-24 23:59:59
```

`-ts` specifies the start time and `-te` specifies the end time.

### 10\. Search by Event Type

```
ausearch -m AVC
```

Searches for SELinux denial (`AVC`) messages.

### 11\. Search by Exit Code

```
ausearch -x /bin/ls --success
ausearch -x /bin/ls --failed
```

`--success` filters successful events, `--failed` filters failed events.

### 12\. Display Options

```
ausearch -i
```

`-i` prints the output in a human-readable format instead of numeric codes.

### 13\. Limit Number of Events

```
ausearch -n 5
```

Displays only the last 5 audit events matching the search.

### 14\. Search by PID or Session

```
ausearch -p 1234
ausearch -s 5678
```

Search by process ID `1234` or session ID `5678`.

### 15\. Search by Raw Message

```
ausearch -m CRED_DISP
```

Search events related to credential usage or disposal.

### 16\. Combine Options

```
ausearch -ua 1001 -sc open -ts today -k mykey
```

Search events for user `1001` that executed `open` system call today with key `mykey`.

* * *

## Summary of Options

| Option | Description |
| --- | --- |
| `-a` | Search by audit ID |
| `-ua` | Search by user ID |
| `-ga` | Search by group ID |
| `-lu` | Search by login UID |
| `-x` | Search by executable path |
| `-sc` | Search by system call |
| `-m` | Search by message type |
| `-k` | Search by key |
| `-ts` | Start time |
| `-te` | End time |
| `--success` | Filter successful events |
| `--failed` | Filter failed events |
| `-i` | Human-readable output |
| `-n` | Limit number of events |
| `-p` | Search by PID |
| `-s` | Search by session ID |

* * *

This guide provides a simple, comprehensive reference for `ausearch` usage.

* * *

* * *

# `auditd` command in Linux

This document explains everything about the auditd command in Linux. It covers what auditd is, why it is used, all options, configuration, and clear examples. The language is simple and easy to copy.

* * *

## What is auditd

auditd is the Linux Audit Daemon.

It runs as a background service and records security related events generated by the Linux kernel. These events are written to audit log files.

auditd itself does not create rules. It only collects and stores events. Rules are managed using auditctl or rules files.

* * *

## Why auditd is used

- Monitor file access and changes
    
- Track command execution
    
- Detect unauthorized activity
    
- Meet security and compliance requirements
    
- Perform forensic analysis after incidents
    

* * *

## auditd service files

- Main configuration file is /etc/audit/auditd.conf
    
- Audit rules directory is /etc/audit/rules.d
    
- Main audit log file is /var/log/audit/audit.log
    

* * *

## Basic auditd command syntax

```
auditd [options]
```

In most systems auditd is managed using systemctl instead of running it directly.

* * *

## auditd command options

### \-f

Run auditd in the foreground instead of background.

Example

```
auditd -f
```

* * *

### \-l

Enable logging to standard error.

Example

```
auditd -l
```

* * *

### \-n

Do not fork into the background.

Example

```
auditd -n
```

* * *

### \-s

Start auditd in a single user safe mode.

Example

```
auditd -s
```

* * *

### \-c

Specify an alternative configuration file.

Example

```
auditd -c /custom/auditd.conf
```

* * *

### \-h

Display help information.

Example

```
auditd -h
```

* * *

### \-v

Display version information.

Example

```
auditd -v
```

* * *

## Managing auditd using systemctl

### Start auditd

```
systemctl start auditd
```

* * *

### Stop auditd

```
systemctl stop auditd
```

* * *

### Restart auditd

```
systemctl restart auditd
```

* * *

### Enable auditd at boot

```
systemctl enable auditd
```

* * *

### Check auditd status

```
systemctl status auditd
```

* * *

## auditd configuration file options

The configuration file is /etc/audit/auditd.conf

Below are the common options inside this file.

### log_file

Location of the audit log file.

Example

```
log_file = /var/log/audit/audit.log
```

* * *

### log_format

Format of audit logs.

Values

- RAW
    
- ENRICHED
    

Example

```
log_format = ENRICHED
```

* * *

### log_group

Group that can read audit logs.

Example

```
log_group = root
```

* * *

### priority_boost

Increase audit daemon scheduling priority.

Example

```
priority_boost = 4
```

* * *

### flush

When audit logs are written to disk.

Values

- NONE
    
- INCREMENTAL
    
- DATA
    
- SYNC
    

Example

```
flush = INCREMENTAL
```

* * *

### freq

Number of records written before flushing.

Example

```
freq = 50
```

* * *

### num_logs

Number of rotated log files to keep.

Example

```
num_logs = 5
```

* * *

### max_log_file

Maximum size of each audit log file in megabytes.

Example

```
max_log_file = 8
```

* * *

### max_log_file_action

Action when log file reaches maximum size.

Values

- IGNORE
    
- SYSLOG
    
- SUSPEND
    
- ROTATE
    
- KEEP_LOGS
    

Example

```
max_log_file_action = ROTATE
```

* * *

### space_left

Disk space threshold in megabytes.

Example

```
space_left = 75
```

* * *

### space_left_action

Action when disk space is low.

Values

- IGNORE
    
- SYSLOG
    
- EMAIL
    
- EXEC
    
- SUSPEND
    

Example

```
space_left_action = SYSLOG
```

* * *

### admin_space_left

Critical disk space threshold.

Example

```
admin_space_left = 50
```

* * *

### admin_space_left_action

Action when disk space is critically low.

Values

- IGNORE
    
- SYSLOG
    
- EMAIL
    
- EXEC
    
- SUSPEND
    
- HALT
    

Example

```
admin_space_left_action = HALT
```

* * *

## Practical examples

### Start auditd and enable auditing

```
systemctl start auditd
auditctl -e 1
```

* * *

### Check audit logs

```
less /var/log/audit/audit.log
```

* * *

### Restart auditd after config change

```
systemctl restart auditd
```

* * *

## Important notes

- auditd must be running for audit rules to work
    
- Stopping auditd may break security compliance
    
- Excessive logging can impact system performance
    

* * *

## Summary

auditd is the core component of the Linux auditing system. It reliably records security events and works together with auditctl, ausearch, and aureport to provide full audit capabilities.

* * *

* * *
